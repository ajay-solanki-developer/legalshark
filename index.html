<!doctype html>
<html lang="en" data-bs-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LegalShark · Legal Case & Document Management</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <script src="nav-loader.js"></script>
  <style>
    :root {
      --lf-bg: #0b0f19;
      --lf-surface: #111827;
      --lf-card: #0f172a;
      --lf-border: #1f2937;
      --lf-accent: #2563eb; /* primary blue */
      --lf-accent-2: #16a34a; /* success green */
      --lf-warn: #f59e0b;
      --lf-danger: #ef4444;
      --lf-text: #0f172a;
      --lf-muted: #6b7280;
      --lf-paper: #ffffff;
    }

    [data-bs-theme="dark"] {
      --bs-body-bg: var(--lf-bg);
      --bs-body-color: #e5e7eb;
      --bs-border-color: var(--lf-border);
      --bs-card-bg: var(--lf-card);
      --bs-card-border-color: var(--lf-border);
      --bs-tertiary-bg: var(--lf-surface);
    }

    .brand-badge {
      font-weight: 700; letter-spacing: 0.5px;
    }
    .sidebar {
      width: 280px;
      background-color: var(--bs-tertiary-bg);
      border-right: 1px solid var(--bs-border-color);
      position: fixed; top: 0; bottom: 0; left: 0; z-index: 1030;
      overflow-y: auto;
    }
    .content-wrap { margin-left: 280px; }

    @media (max-width: 991.98px) {
      .sidebar { left: -100%; transition: left .2s ease; }
      .sidebar.show { left: 0; }
      .content-wrap { margin-left: 0; }
    }

    .stat-card .icon {
      font-size: 1.6rem; width: 3rem; height: 3rem; display: grid; place-items: center;
      border-radius: .8rem;
    }
    .table thead th { font-size: 0.85rem; text-transform: uppercase; letter-spacing: .04em; }
    .doc-row:hover { background: rgba(37, 99, 235, 0.08); }
    .avatar {
      width: 32px; height: 32px; border-radius: 50%;
      display: inline-grid; place-items: center; font-size: .85rem; font-weight: 600;
      background: #dbeafe; color: #1e40af;
    }
    .tag {
      border: 1px solid var(--bs-border-color); border-radius: 999px; padding: .2rem .6rem; font-size: .75rem;
    }
    /* === Configurable Theme Tokens === */
  :root {
    --lf-radius: 1rem;           /* 1rem = rounded-2xl */
    --lf-density-y: 0.75rem;     /* control vertical padding */
    --lf-btn-shape: 999px;       /* 999px = pill; 0.5rem = square */
    --lf-primary: var(--lf-accent);
  }

  .rounded-dna { border-radius: var(--lf-radius) !important; }
  .btn { border-radius: var(--lf-btn-shape); }
  .btn-square { --lf-btn-shape: .5rem; }
  .btn-pill { --lf-btn-shape: 999px; }
  .dense-y .btn, .dense-y .nav-link, .dense-y .form-control, .dense-y .input-group-text, .dense-y .list-group-item, .dense-y .dropdown-item {
    padding-top: calc(var(--lf-density-y));
    padding-bottom: calc(var(--lf-density-y));
  }
  .menu-outline .sidebar a { border:1px solid transparent; }
  .menu-outline .sidebar a:hover { border-color: var(--bs-border-color); border-radius: .6rem; }
  .menu-filled .sidebar a:hover { background: rgba(37,99,235,.08); border-radius: .6rem; }

  /* Utility to reflect primary color */
  .text-primary-dyn { color: var(--lf-primary) !important; }
  .bg-primary-dyn { background-color: color-mix(in srgb, var(--lf-primary) 15%, transparent); }
  .border-primary-dyn { border-color: var(--lf-primary) !important; }
  /* === Dynamic theming (site-wide) === */
  body.lf-theme-gradient {
    background:
      radial-gradient(1200px 600px at -10% -10%, rgba(var(--bs-primary-rgb),0.18), transparent 60%),
      linear-gradient(180deg, rgba(var(--bs-primary-rgb),0.08), transparent 300px),
      var(--bs-body-bg);
  }
  .brand-header {
    background:
      linear-gradient(135deg, rgba(var(--bs-primary-rgb),0.22), rgba(var(--bs-primary-rgb),0.10) 60%, transparent 100%),
      var(--bs-body-bg);
    border-bottom: 1px solid color-mix(in srgb, var(--lf-primary) 25%, var(--bs-border-color));
    backdrop-filter: saturate(120%) blur(6px);
  }
  /* Make nav react to primary */
  .sidebar a:hover { color: var(--lf-primary) !important; }
  .brand-badge { color: var(--lf-primary); }
  /* Subtle primary helpers */
  .bg-primary-subtle { background-color: rgba(var(--bs-primary-rgb), .12) !important; }
  .text-bg-primary { background-color: rgba(var(--bs-primary-rgb), .85) !important; }
</style>
</head>
<body class="lf-theme-gradient">

  <!-- Sidebar -->
  <nav id="sidebar" class="sidebar p-3">
    <div class="d-flex align-items-center mb-3">
      <i class="bi bi-scales me-2 text-primary"></i>
      <span class="brand-badge">LegalShark</span>
      <span class="ms-2 text-secondary"></span>
    </div>

    <div class="mb-3">
      <input id="globalSearch" type="search" class="form-control" placeholder="Search matters, documents, clients…"/>
    </div>

    <small class="text-uppercase text-secondary">Navigation</small>
    <div id="mainNav"></div>

    <hr/>
    <small class="text-uppercase text-secondary">Quick Filters</small>
    <div class="mt-2 d-flex flex-wrap gap-2">
      <span class="tag">Upcoming hearings</span>
      <span class="tag">Awaiting signature</span>
      <span class="tag">High priority</span>
    </div>

    <hr/>
    <div class="d-grid gap-2">
      <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#uploadModal"><i class="bi bi-cloud-upload me-2"></i>Upload Document</button>
      <button class="btn btn-outline-secondary" id="toggleTheme"><i class="bi bi-moon-stars me-2"></i>Toggle Dark</button>
    </div>
  </nav>

  <!-- Topbar -->
  <header class="content-wrap border-bottom brand-header sticky-top">
    <div class="container-fluid py-2">
      <div class="d-flex align-items-center justify-content-between">
        <div class="d-flex align-items-center gap-2">
          <button class="btn btn-outline-secondary d-lg-none" id="sidebarToggle"><i class="bi bi-list"></i></button>
          <span class="fw-semibold">Dashboard</span>
        </div>
        <div class="d-flex align-items-center gap-3">
          <button class="btn btn-outline-secondary d-none d-md-inline" data-bs-toggle="offcanvas" data-bs-target="#themeSettings"><i class="bi bi-sliders"></i> Theme</button>
          <div class="input-group" style="max-width:360px;">
            <span class="input-group-text"><i class="bi bi-search"></i></span>
            <input type="search" class="form-control" placeholder="Quick search…"/>
          </div>
          <button class="btn position-relative">
            <i class="bi bi-bell"></i>
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">3</span>
          </button>
          <div class="dropdown">
            <button class="btn dropdown-toggle d-flex align-items-center gap-2" data-bs-toggle="dropdown">
              <span class="avatar">BA</span><span class="d-none d-sm-inline">Basir Ahmad</span>
            </button>
            <ul class="dropdown-menu dropdown-menu-end">
              <li><a class="dropdown-item" href="#">Profile</a></li>
              <li><a class="dropdown-item" href="#">Preferences</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" href="#">Sign out</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="content-wrap">
    <div class="container-fluid py-4">
      <!-- Stats Row -->
      <div class="row g-3 mb-4">
        <div class="col-12 col-md-6 col-xl-3">
          <div class="card stat-card">
            <div class="card-body d-flex align-items-center justify-content-between">
              <div>
                <div class="text-secondary small">Open Matters</div>
                <div class="fs-4 fw-semibold">128</div>
              </div>
              <div class="icon bg-primary-subtle text-primary"><i class="bi bi-folder2-open"></i></div>
            </div>
          </div>
        </div>
        <div class="col-12 col-md-6 col-xl-3">
          <div class="card stat-card">
            <div class="card-body d-flex align-items-center justify-content-between">
              <div>
                <div class="text-secondary small">Documents Today</div>
                <div class="fs-4 fw-semibold">42</div>
              </div>
              <div class="icon bg-success-subtle text-success"><i class="bi bi-file-earmark-text"></i></div>
            </div>
          </div>
        </div>
        <div class="col-12 col-md-6 col-xl-3">
          <div class="card stat-card">
            <div class="card-body d-flex align-items-center justify-content-between">
              <div>
                <div class="text-secondary small">Hearings This Week</div>
                <div class="fs-4 fw-semibold">9</div>
              </div>
              <div class="icon bg-warning-subtle text-warning"><i class="bi bi-calendar-event"></i></div>
            </div>
          </div>
        </div>
        <div class="col-12 col-md-6 col-xl-3">
          <div class="card stat-card">
            <div class="card-body d-flex align-items-center justify-content-between">
              <div>
                <div class="text-secondary small">Pending Signatures</div>
                <div class="fs-4 fw-semibold">5</div>
              </div>
              <div class="icon bg-danger-subtle text-danger"><i class="bi bi-pen"></i></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Kanban-ish Quick Board -->
      <div class="row g-3 mb-4">
        <div class="col-12 col-xl-4">
          <div class="card h-100">
            <div class="card-header d-flex align-items-center justify-content-between">
              <span class="fw-semibold">New Filings</span>
              <span class="badge text-bg-primary">6</span>
            </div>
            <ul class="list-group list-group-flush small">
              <li class="list-group-item d-flex justify-content-between align-items-center">
                Gupta v. Apex Ltd. <span class="badge rounded-pill text-bg-secondary">Civil</span>
              </li>
              <li class="list-group-item d-flex justify-content-between align-items-center">
                State v. Rao <span class="badge rounded-pill text-bg-secondary">Criminal</span>
              </li>
              <li class="list-group-item d-flex justify-content-between align-items-center">
                Mira Corp Compliance <span class="badge rounded-pill text-bg-secondary">Corporate</span>
              </li>
            </ul>
          </div>
        </div>
        <div class="col-12 col-xl-4">
          <div class="card h-100">
            <div class="card-header d-flex align-items-center justify-content-between">
              <span class="fw-semibold">Awaiting Review</span>
              <span class="badge text-bg-warning">3</span>
            </div>
            <div class="list-group list-group-flush">
              <a href="#" class="list-group-item list-group-item-action">Affidavit – Gupta v. Apex</a>
              <a href="#" class="list-group-item list-group-item-action">Draft Motion – Samir v. Delta</a>
              <a href="#" class="list-group-item list-group-item-action">NDA – Mira Corp</a>
            </div>
          </div>
        </div>
        <div class="col-12 col-xl-4">
          <div class="card h-100">
            <div class="card-header d-flex align-items-center justify-content-between">
              <span class="fw-semibold">Upcoming Hearings</span>
              <a class="small" href="#">View calendar</a>
            </div>
            <div class="card-body">
              <ul class="list-unstyled mb-0">
                <li class="mb-3"><i class="bi bi-clock me-2"></i> Sep 06, 10:30 — Gupta v. Apex (Civil Court 2)</li>
                <li class="mb-3"><i class="bi bi-clock me-2"></i> Sep 07, 12:00 — State v. Rao (Sessions Court)</li>
                <li><i class="bi bi-clock me-2"></i> Sep 09, 15:00 — Mira Corp (Company Law Board)</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- Documents Section -->
      <section id="docs-section" class="mb-4">
        <div class="d-flex align-items-center justify-content-between mb-2">
          <h5 class="mb-0">Recent Documents</h5>
          <div class="d-flex gap-2">
            <button class="btn btn-outline-secondary" data-bs-toggle="offcanvas" data-bs-target="#filterCanvas"><i class="bi bi-funnel"></i> Filters</button>
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#uploadModal"><i class="bi bi-cloud-upload"></i> Upload</button>
          </div>
        </div>

        <div class="table-responsive">
          <table class="table align-middle mb-0">
            <thead>
              <tr>
                <th>#</th>
                <th>Title</th>
                <th>Matter</th>
                <th>Type</th>
                <th>Owner</th>
                <th>Updated</th>
                <th>Status</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              <tr class="doc-row">
                <td>1</td>
                <td><i class="bi bi-file-earmark-text me-1"></i> Affidavit – Witness A</td>
                <td>Gupta v. Apex</td>
                <td>Affidavit</td>
                <td><span class="avatar me-2">AS</span>Ajay Solanki</td>
                <td>Today, 12:04</td>
                <td><span class="badge text-bg-warning">Awaiting signature</span></td>
                <td class="text-end">
                  <div class="btn-group">
                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-eye"></i></button>
                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-three-dots"></i></button>
                  </div>
                </td>
              </tr>
              <tr class="doc-row">
                <td>2</td>
                <td><i class="bi bi-filetype-pdf me-1"></i> Petition – Injunction</td>
                <td>State v. Rao</td>
                <td>Petition</td>
                <td><span class="avatar me-2">JK</span>Jhankhana Koshti</td>
                <td>Yesterday</td>
                <td><span class="badge text-bg-success">Approved</span></td>
                <td class="text-end">
                  <div class="btn-group">
                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-eye"></i></button>
                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-share"></i></button>
                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-three-dots"></i></button>
                  </div>
                </td>
              </tr>
              <tr class="doc-row">
                <td>3</td>
                <td><i class="bi bi-filetype-doc me-1"></i> Draft NDA – Mira Corp</td>
                <td>Mira Corp</td>
                <td>Agreement</td>
                <td><span class="avatar me-2">RM</span>R. Mehta</td>
                <td>Sep 02</td>
                <td><span class="badge text-bg-primary">In review</span></td>
                <td class="text-end">
                  <div class="btn-group">
                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-eye"></i></button>
                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-three-dots"></i></button>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Activity -->
      <div class="card">
        <div class="card-header">
          <strong>Recent Activity</strong>
        </div>
        <div class="card-body">
          <ul class="list-unstyled mb-0 small">
            <li class="mb-2"><i class="bi bi-clock-history me-2"></i> You uploaded <em>Affidavit – Witness A</em> to <em>Gupta v. Apex</em></li>
            <li class="mb-2"><i class="bi bi-clock-history me-2"></i> Ajay commented on <em>Draft NDA – Mira Corp</em></li>
            <li><i class="bi bi-clock-history me-2"></i> Hearing scheduled for <em>State v. Rao</em> — Sep 07, 12:00</li>
          </ul>
        </div>
      </div>

    </div>
  </main>

  <!-- Offcanvas Filters -->
  <div class="offcanvas offcanvas-end" tabindex="-1" id="filterCanvas">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title">Filters</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body">
      <div class="mb-3">
        <label class="form-label">Matter Type</label>
        <select class="form-select">
          <option>All</option>
          <option>Civil</option>
          <option>Criminal</option>
          <option>Corporate</option>
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label">Status</label>
        <select class="form-select">
          <option>Any</option>
          <option>Awaiting signature</option>
          <option>In review</option>
          <option>Approved</option>
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label">Owner</label>
        <input class="form-control" placeholder="Type a name" />
      </div>
      <button class="btn btn-primary w-100"><i class="bi bi-funnel"></i> Apply</button>
    </div>
  </div>

  <!-- Upload Modal -->
  <div class="modal fade" id="uploadModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Upload Document</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label class="form-label">Choose file</label>
            <input type="file" class="form-control" />
          </div>
          <div class="row g-3">
            <div class="col-12 col-md-6">
              <label class="form-label">Matter</label>
              <input class="form-control" placeholder="Search or select…" />
            </div>
            <div class="col-12 col-md-6">
              <label class="form-label">Document Type</label>
              <select class="form-select">
                <option>Petition</option>
                <option>Affidavit</option>
                <option>Order</option>
                <option>Agreement</option>
              </select>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
          <button class="btn btn-primary" id="btnUpload">
            <i class="bi bi-cloud-upload me-1"></i> Upload
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 1080">
    <div id="toastUpload" class="toast align-items-center text-bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body">
          Document uploaded successfully.
        </div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const sidebar = document.getElementById('sidebar');
    document.getElementById('sidebarToggle')?.addEventListener('click', () => {
      sidebar.classList.toggle('show');
    });

    document.getElementById('toggleTheme')?.addEventListener('click', () => {
      const html = document.documentElement;
      html.setAttribute('data-bs-theme', html.getAttribute('data-bs-theme') === 'dark' ? 'light' : 'dark');
    });

    document.getElementById('btnUpload')?.addEventListener('click', () => {
      const toast = new bootstrap.Toast(document.getElementById('toastUpload'));
      toast.show();
      const modalEl = document.getElementById('uploadModal');
      bootstrap.Modal.getInstance(modalEl)?.hide();
    });
  </script>
  <!-- Theme Settings Offcanvas -->
  <div class="offcanvas offcanvas-end" tabindex="-1" id="themeSettings">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title">Theme & Layout</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body small">
      <div class="mb-3">
        <label class="form-label">Brand name</label>
        <input id="cfgBrand" class="form-control" placeholder="LegalShark" />
      </div>
      <div class="row g-3">
        <div class="col-6">
          <label class="form-label">Color scheme</label>
          <select id="cfgScheme" class="form-select">
            <option value="auto">Auto</option>
            <option value="light">Light</option>
            <option value="dark">Dark</option>
          </select>
        </div>
        <div class="col-6">
          <label class="form-label">Primary color</label>
          <input id="cfgPrimary" type="color" class="form-control form-control-color" value="#2563eb" />
        </div>
      </div>
      <div class="row g-3 mt-1">
        <div class="col-6">
          <label class="form-label">Corners</label>
          <select id="cfgRadius" class="form-select">
            <option value="0.5rem">Square</option>
            <option value="1rem" selected>Rounded</option>
            <option value="1.5rem">Extra rounded</option>
          </select>
        </div>
        <div class="col-6">
          <label class="form-label">Buttons</label>
          <select id="cfgBtn" class="form-select">
            <option value="pill" selected>Pill</option>
            <option value="square">Square</option>
          </select>
        </div>
      </div>
      <div class="row g-3 mt-1">
        <div class="col-6">
          <label class="form-label">Density</label>
          <select id="cfgDensity" class="form-select">
            <option value="cozy">Cozy</option>
            <option value="compact">Compact</option>
          </select>
        </div>
        <div class="col-6">
          <label class="form-label">Menu hover style</label>
          <select id="cfgMenu" class="form-select">
            <option value="filled" selected>Filled</option>
            <option value="outline">Outline</option>
          </select>
        </div>
      </div>
      <div class="d-flex gap-2 mt-3">
        <button id="cfgApply" class="btn btn-primary"><i class="bi bi-check2"></i> Apply</button>
        <button id="cfgReset" class="btn btn-outline-secondary"><i class="bi bi-arrow-counterclockwise"></i> Reset</button>
      </div>
      <hr/>
      <p class="text-secondary mb-0">Settings are saved to your browser (localStorage).</p>
    </div>
  </div>

  <script>
    // Lightweight theme configurator with localStorage persistence
    const $ = (sel) => document.querySelector(sel);
    const htmlEl = document.documentElement;

    const defaultCfg = {
      brand: 'LegalShark',
      scheme: 'auto',           // light | dark | auto
      primary: '#2563eb',
      radius: '1rem',
      btn: 'pill',              // pill | square
      density: 'cozy',          // cozy | compact
      menu: 'filled'            // filled | outline
    };

    const loadCfg = () => ({ ...defaultCfg, ...(JSON.parse(localStorage.getItem('LegalSharkCfg')||'{}')) });
    const saveCfg = (cfg) => localStorage.setItem('LegalSharkCfg', JSON.stringify(cfg));

    function hexToRgb(hex){
      const m = /^#?([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i.exec(hex);
      return m ? { r: parseInt(m[1],16), g: parseInt(m[2],16), b: parseInt(m[3],16) } : null;
    }

    function applyCfg(cfg){
      // Brand
      const brandEl = document.querySelector('.brand-badge');
      if (brandEl) brandEl.textContent = cfg.brand || 'LegalShark';

      // Scheme
      let scheme = cfg.scheme;
      if(scheme === 'auto'){
        scheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      }
      htmlEl.setAttribute('data-bs-theme', scheme);

      // Primary + radii
      htmlEl.style.setProperty('--lf-primary', cfg.primary);
      htmlEl.style.setProperty('--lf-accent', cfg.primary);
      const rgb = hexToRgb(cfg.primary) || {r:37,g:99,b:235};
      htmlEl.style.setProperty('--bs-primary', cfg.primary);
      htmlEl.style.setProperty('--bs-primary-rgb', `${rgb.r}, ${rgb.g}, ${rgb.b}`);
      htmlEl.style.setProperty('--bs-link-color', cfg.primary);
      htmlEl.style.setProperty('--lf-radius', cfg.radius);

      // Buttons
      htmlEl.classList.toggle('btn-square', cfg.btn === 'square');
      htmlEl.classList.toggle('btn-pill', cfg.btn === 'pill');

      // Density
      htmlEl.classList.toggle('dense-y', cfg.density === 'compact');

      // Menu style
      htmlEl.classList.toggle('menu-filled', cfg.menu === 'filled');
      htmlEl.classList.toggle('menu-outline', cfg.menu === 'outline');
    }

    function hydrateControls(cfg){
      $('#cfgBrand').value = cfg.brand;
      $('#cfgScheme').value = cfg.scheme;
      $('#cfgPrimary').value = cfg.primary;
      $('#cfgRadius').value = cfg.radius;
      $('#cfgBtn').value = cfg.btn;
      $('#cfgDensity').value = cfg.density;
      $('#cfgMenu').value = cfg.menu;
    }

    document.addEventListener('DOMContentLoaded', () => {
      const cfg = loadCfg();
      applyCfg(cfg);
      hydrateControls(cfg);

      $('#cfgApply').addEventListener('click', () => {
        const newCfg = {
          brand: $('#cfgBrand').value.trim() || 'LegalShark',
          scheme: $('#cfgScheme').value,
          primary: $('#cfgPrimary').value,
          radius: $('#cfgRadius').value,
          btn: $('#cfgBtn').value,
          density: $('#cfgDensity').value,
          menu: $('#cfgMenu').value
        };
        saveCfg(newCfg); applyCfg(newCfg);
      });

      $('#cfgReset').addEventListener('click', () => {
        saveCfg(defaultCfg); applyCfg(defaultCfg); hydrateControls(defaultCfg);
      });

      // Also react to OS theme changes when in auto
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
        const c = loadCfg(); if(c.scheme==='auto'){ applyCfg(c); }
      });
    });
  </script>
</body>
</html>